<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Transférer de l'argent</title>
  <link rel="stylesheet" th:href="@{/css/common.css}">
  <link rel="stylesheet" th:href="@{/css/transaction.css}" />
</head>

<body>
  <div th:replace="~{fragments/header :: header}"></div>

  <main class="transaction-page">
    <output>
        <span th:if="${transferInfo}" th:text="${transferInfo}" class="flash-feedback"></span>
        <span th:if="${transferError}" th:text="${transferError}" class="field-error"></span>
        <span th:if="${error}" th:text="${error}" class="field-error"></span>
    </output>  

    <form 
     class="transaction-form" 
     th:action="@{/transfer}" 
     method="post" 
     th:object="${transactionDto}">  

      <label class="sr-only" for="friendList">Sélectionner une relation</label>
      <select
       class="relation-input"
       id="friendList"
       th:field="*{friendId}"
       placeholder="Sélectionner une relation">
        <option 
         th:each="friend : ${friendList}"
         th:value="${friend.id}"
         th:text="${friend.username}">
        </option>
      </select>  

      <label class="sr-only" for="description">Description</label>
      <input
       class="description-input"
       id="description"
       th:field="*{description}"
       type="text"
       maxlength="150"
       placeholder="Description"
       aria-describedby="description-error" />
      <p
       class="field-error"
       id="description-error"
       th:if="${#fields.hasErrors('description')}"
       th:errors="*{description}"></p>
      
      <label class="sr-only" for="amount">Montant</label>
      <input
       class="amount-input"
       id="amount"
       th:field="*{amount}"
       type="number"
       step="0.01"
       min="0.01"
       placeholder="0€"
       aria-describedby="amount-error" />
      <p
       class="field-error"
       id="amount-error"
       th:if="${#fields.hasErrors('amount')}"
       th:errors="*{amount}"></p>
      
      <button class="payment-button" type="submit">Payer</button>
    </form>  

    <table>
      <thead>
        <tr>
          <th colspan="1">Mes transactions</th>
        </tr>
        <tr>
          <th>Relations</th>
          <th>Description</th>
          <th>Montant</th>
        </tr>
      </thead>
      
      <tbody>
      <tr th:each="transaction : ${transactionList}">
        <td th:text="${transaction.receiver.username}">Relations</td>
        <td th:text="${transaction.description}">Description</td>
        <td th:text="${transaction.formattedAmount}">Montant</td>
      </tr>
      </tbody>
    </table>
  </main>
</body>
</html>
